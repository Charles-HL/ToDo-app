"use strict";(self.webpackChunktodo_app=self.webpackChunktodo_app||[]).push([[152],{9152:(Y,u,a)=>{a.r(u),a.d(u,{TasksModule:()=>N});var l=a(6895),k=a(9197),T=a(4004),x=a(262),C=a(9751),v=a(2843),t=a(4650),M=a(4703),O=a(6570),P=a(7399),p=a(3546),h=a(7392),m=a(4463);function y(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"mat-card",8)(1,"mat-card-content")(2,"app-round-checkbox",9),t.NdJ("onChange",function(o){t.CHM(n);const i=t.oxw();return t.KtG(i.taskStateUpdated(o))}),t.qZA(),t.TgZ(3,"div",10),t.NdJ("click",function(){const i=t.CHM(n).$implicit,d=t.oxw();return t.KtG(d.openTask(i.id))}),t._uU(4),t.qZA()()()}if(2&e){const n=c.$implicit;t.xp6(2),t.Q6J("checked",n.done)("data_id",n.id),t.xp6(2),t.Oqu(n.name)}}function S(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"mat-card",13)(1,"mat-card-content")(2,"app-round-checkbox",9),t.NdJ("onChange",function(o){t.CHM(n);const i=t.oxw(2);return t.KtG(i.taskStateUpdated(o))}),t.qZA(),t.TgZ(3,"div",14),t.NdJ("click",function(){const i=t.CHM(n).$implicit,d=t.oxw(2);return t.KtG(d.openTask(i.id))}),t._uU(4),t.qZA()()()}if(2&e){const n=c.$implicit;t.xp6(2),t.Q6J("checked",n.done)("data_id",n.id),t.xp6(2),t.Oqu(n.name)}}function U(e,c){if(1&e&&(t.TgZ(0,"div",11),t.YNc(1,S,5,3,"mat-card",12),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.tasksDone)}}let g=(()=>{class e{constructor(n,s,o,i,d){this.popupService=n,this.apiService=s,this.route=o,this.router=i,this.location=d,this.tasksUnDone=[],this.tasksDone=[]}ngOnInit(){console.log("tasks init"),this.getTasks()}getTasks(){this.apiService.getTasks().subscribe(n=>{this.tasksUnDone=n.filter(s=>!s.done),this.tasksDone=n.filter(s=>s.done)}),this.routeSub=this.route.params.subscribe(n=>{void 0!==n.id&&this.taskId!==parseInt(n.id)?(this.taskId=parseInt(n.id),this.openTask(this.taskId)):void 0===n.id&&void 0!==this.taskId&&(this.task=void 0,this.taskId=void 0)})}ngOnDestroy(){this.routeSub&&this.routeSub.unsubscribe()}taskStateUpdated(n){this.internalTaskStateUpdated(n).subscribe()}internalTaskStateUpdated(n){return this.apiService.postIsTaskDone(n.data_id,n.checked).pipe((0,T.U)(s=>(this.updateTaskList(s),s)))}updateTaskList(n){let s=this.tasksUnDone.concat(this.tasksDone);const o=s.findIndex(r=>r.id===n.id);s.splice(o,1);let i=[],d=[];s.forEach(r=>{!0===r.done?d.push(r):i.push(r)}),!0===n.done?d.unshift(n):i.unshift(n),this.tasksUnDone=i,this.tasksDone=d}openTask(n){this.location.replaceState("/task/"+n),this.taskId=n,this.apiService.getTask(n).pipe((0,x.K)(s=>404===s.status||401===s.status?new C.y(o=>{this.taskId=void 0,this.task=void 0,this.returnToTaskList(),o.complete()}):(0,v._)(()=>s))).subscribe(s=>{this.task=s,this.popupService.openTask(this.task,this.returnToTaskList.bind(this),this.internalTaskStateUpdated.bind(this))})}returnToTaskList(){this.location.replaceState("/task"),this.taskId=void 0,this.task=void 0}openAddTaskDialog(){this.popupService.openAddTask(this.addTask.bind(this))}addTask(n){this.apiService.putTask(n).subscribe(s=>{!0===s.done?this.tasksDone.unshift(s):this.tasksUnDone.unshift(s)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(M.q),t.Y36(O.s),t.Y36(k.gz),t.Y36(k.F0),t.Y36(l.Ye))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-tasks"]],decls:13,vars:5,consts:[[1,"tasks-container"],[1,"empty-header"],[1,"task-list"],["class","common-task-tile task-tile",4,"ngFor","ngForOf"],["class","undone-task-container",4,"ngIf"],[1,"task-add-container","transparent-background"],[1,"common-task-tile","task-tile","task-add-card",3,"click"],[1,"task-title"],[1,"common-task-tile","task-tile"],[1,"task-checkbox",3,"checked","data_id","onChange"],[1,"task-title",3,"click"],[1,"undone-task-container"],["class","common-task-tile task-tile undone-task-tile",4,"ngFor","ngForOf"],[1,"common-task-tile","task-tile","undone-task-tile"],[1,"task-title","undone-task-title",3,"click"]],template:function(n,s){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t.YNc(3,y,5,3,"mat-card",3),t.YNc(4,U,2,1,"div",4),t.TgZ(5,"div",5)(6,"mat-card",6),t.NdJ("click",function(){return s.openAddTaskDialog()}),t.TgZ(7,"mat-card-content")(8,"mat-icon"),t._uU(9,"add"),t.qZA(),t.TgZ(10,"div",7),t._uU(11),t.ALo(12,"translate"),t.qZA()()()()()()),2&n&&(t.xp6(3),t.Q6J("ngForOf",s.tasksUnDone),t.xp6(1),t.Q6J("ngIf",s.tasksDone.length>0),t.xp6(7),t.Oqu(t.lcZ(12,3,"Add task")))},dependencies:[l.sg,l.O5,P.K,p.a8,p.dn,h.Hw,m.X$],styles:[".tasks-container[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column;align-items:center}.tasks-container[_ngcontent-%COMP%]   .task-list[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding-top:20px;width:100%;flex-direction:column;height:100%;align-items:center;overflow-y:overlay}.tasks-container[_ngcontent-%COMP%]   .task-list[_ngcontent-%COMP%]   .undone-task-container[_ngcontent-%COMP%]{margin-top:20px;width:inherit;display:inherit;justify-content:inherit;flex-direction:inherit;align-items:inherit}.tasks-container[_ngcontent-%COMP%]   .task-list[_ngcontent-%COMP%]   .undone-task-container[_ngcontent-%COMP%]   .undone-task-title[_ngcontent-%COMP%]{color:#ffffffa6;text-decoration:line-through}.tasks-container[_ngcontent-%COMP%]   .task-tile[_ngcontent-%COMP%]{max-width:1000px;width:90%;height:51px;margin-bottom:8px}.tasks-container[_ngcontent-%COMP%]   .task-tile[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{height:51px;padding:0 16px;display:flex;flex-direction:row;align-items:center;justify-content:flex-start}.tasks-container[_ngcontent-%COMP%]   .task-tile[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{margin-left:5px;width:100%;display:flex;height:100%;align-items:center}.tasks-container[_ngcontent-%COMP%]   .task-add-container[_ngcontent-%COMP%]{position:absolute;width:90%;max-width:1000px;display:flex;justify-content:center;padding-top:10px;z-index:1;bottom:0}.tasks-container[_ngcontent-%COMP%]   .task-add-container[_ngcontent-%COMP%]   .task-add-card[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:20px;width:100%}"]}),e})();var f=a(7574);const Z=[{path:"",component:g,canActivate:[f.a]},{path:":id",component:g,canActivate:[f.a]}];let _=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[k.Bz.forChild(Z),k.Bz]}),e})();var D=a(9549),A=a(4144),I=a(4006),b=a(4859),F=a(5239),J=a(5737);let N=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,_,D.lN,b.ot,F.S,m.aw.forChild({extend:!0}),A.c,p.QW,I.UX,h.Ps,J.a]}),e})()}}]);